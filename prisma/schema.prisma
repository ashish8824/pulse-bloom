datasource db {
  provider = "postgresql"
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// USER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String
  createdAt DateTime @default(now())

  moods  MoodEntry[]
  habits Habit[]
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOOD
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model MoodEntry {
  id        String   @id @default(uuid())
  moodScore Int
  emoji     String
  journalId String?
  userId    String
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HABITS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

enum HabitFrequency {
  daily
  weekly
}

// Category helps users organize habits by life area.
// Stored as an enum so the frontend can filter/group habits cleanly.
enum HabitCategory {
  health
  fitness
  learning
  mindfulness
  productivity
  custom
}

model Habit {
  id           String         @id @default(uuid())
  title        String
  description  String?
  frequency    HabitFrequency
  category     HabitCategory  @default(custom)     // NEW: life area this habit belongs to
  color        String?                              // NEW: hex color for frontend UI (#FF5733)
  icon         String?                              // NEW: emoji icon ("ðŸ§˜", "ðŸ“š", "ðŸ’ª")
  targetPerWeek Int?                               // NEW: optional goal (e.g. 5/7 days for daily habits)
  sortOrder    Int            @default(0)           // NEW: user-controlled display order
  isArchived   Boolean        @default(false)       // soft-delete: preserves log history
  reminderTime String?                              // NEW: "08:00" â€” time to send daily reminder
  reminderOn   Boolean        @default(false)       // NEW: toggle reminder on/off without clearing time
  userId       String
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt

  user User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  logs HabitLog[]

  // Prevents duplicate habits (same title+frequency per user, case handled in app)
  @@unique([userId, title, frequency])
  // Index on userId for fast per-user queries
  @@index([userId])
}

model HabitLog {
  id        String   @id @default(uuid())
  habitId   String
  date      DateTime // normalized: midnight for daily, Monday midnight for weekly
  completed Boolean  @default(true)
  note      String?  // optional user annotation ("felt great today")
  createdAt DateTime @default(now())

  habit Habit @relation(fields: [habitId], references: [id], onDelete: Cascade)

  // One log per habit per period â€” DB-level duplicate prevention
  @@unique([habitId, date])
  // Index for fast log lookups by habit
  @@index([habitId])
}
